<h2>Lista de Alunos</h2>

<p *ngIf="errorMessage" style="color: red;">{{ errorMessage }}</p>

<div style="margin-bottom: 15px;">
  <button (click)="startCreating()" *ngIf="!creatingNew">â• Adicionar Novo Aluno</button>
</div>

<div *ngIf="students.length > 0 || creatingNew">
  <table border="1" cellpadding="5" cellspacing="0" style="border-collapse: collapse; width: 100%;">
    <thead style="background-color: #f0f0f0;">
      <tr>
        <th>ID</th>
        <th>Nome</th>
        <th>MatrÃ­cula (ID TCS)</th>
        <th>AÃ§Ãµes</th>
      </tr>
    </thead>
    <tbody>

      <!-- LINHA DE CRIAÃ‡ÃƒO -->
      <tr *ngIf="creatingNew">
        <td>Nova</td>
        <td><input [(ngModel)]="newStudentName" placeholder="Nome do aluno" /></td>
        <td><input [(ngModel)]="newStudentIdTcs" placeholder="MatrÃ­cula" /></td>
        <td>
          <button (click)="saveNewStudent()">ğŸ’¾ Salvar</button>
          <button (click)="cancelCreating()">âœ–ï¸ Cancelar</button>
        </td>
      </tr>

      <!-- LINHAS EXISTENTES -->
      <tr *ngFor="let student of students">
        <td>{{ student.id }}</td>

        <td>
          <ng-container *ngIf="editingStudentId === student.id; else viewName">
            <input [(ngModel)]="editedName" />
          </ng-container>
          <ng-template #viewName>
            {{ student.name }}
          </ng-template>
        </td>

        <td>
          <ng-container *ngIf="editingStudentId === student.id; else viewIdTcs">
            <input [(ngModel)]="editedIdTcs" />
          </ng-container>
          <ng-template #viewIdTcs>
            {{ student.idTcs }}
          </ng-template>
        </td>

        <td>
          <ng-container *ngIf="editingStudentId === student.id; else actionButtons">
            <button (click)="saveStudent(student.id)">ğŸ’¾ Salvar</button>
            <button (click)="editingStudentId = null">âœ–ï¸ Cancelar</button>
          </ng-container>
          <ng-template #actionButtons>
            <button (click)="editStudent(student)">âœï¸ Editar</button>
            <button (click)="deleteStudent(student.id)">ğŸ—‘ï¸ Excluir</button>
          </ng-template>
        </td>
      </tr>

    </tbody>
  </table>
</div>

<div *ngIf="students.length === 0 && !errorMessage && !creatingNew">
  <p>Nenhum aluno encontrado.</p>
</div>
